local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Pablo OP - Pixel Blade",
   LoadingTitle = "Carregando...",
   LoadingSubtitle = "Auto Farm otimizado + preciso",
   ConfigurationSaving = {Enabled = false},
   Discord = {Enabled = false},
   KeySystem = false
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")

local Player = Players.LocalPlayer
local remotes = ReplicatedStorage:WaitForChild("remotes")
local onHitRemote = remotes:WaitForChild("onHit")

local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

local KillAura = false
local AutoFarm = false
local FlyEnabled = false
local NoClipEnabled = false
local InfiniteJump = false
local MobESP = false
local VisibleHitbox = false
local Fullbright = false

local AuraRange = 300
local FlySpeed = 50
local WalkSpeedVal = 16
local JumpPowerVal = 50
local FarmHeightOffset = 40

local BV, FlyConn, NoClipConn
local EspHighlights = {}
local HitboxParts = {}

local function UpdateCharacter(char)
   Character = char
   Humanoid = char:WaitForChild("Humanoid")
   RootPart = char:WaitForChild("HumanoidRootPart")
   Humanoid.WalkSpeed = WalkSpeedVal
   Humanoid.JumpPower = JumpPowerVal
end

Player.CharacterAdded:Connect(UpdateCharacter)

local function IsValidEnemy(obj)
   if Players:GetPlayerFromCharacter(obj) then return false end
   local hum = obj:FindFirstChild("Humanoid")
   local hrp = obj:FindFirstChild("HumanoidRootPart")
   if not hum or not hrp then return false end
   if hum.Health <= 0 then return false end
   if hum.MaxHealth <= 5 then return false end
   if hrp.Position.Y < 5 then return false end
   return true
end

local function GetEnemies()
   local enemies = {}
   if not RootPart then return enemies end
   local rootPos = RootPart.Position
   local count = 0
   for _, obj in ipairs(Workspace:GetChildren()) do
      if count >= 30 then break end
      if IsValidEnemy(obj) then
         local hrp = obj.HumanoidRootPart
         local dist = (rootPos - hrp.Position).Magnitude
         if dist <= AuraRange then
            table.insert(enemies, {hrp = hrp, hum = obj.Humanoid})
            count += 1
         end
      end
   end
   return enemies
end

local function ToggleNoClip(state)
   NoClipEnabled = state
   if NoClipConn then NoClipConn:Disconnect() NoClipConn = nil end
   if state then
      NoClipConn = RunService.Stepped:Connect(function()
         if Character then
            for _, part in ipairs(Character:GetDescendants()) do
               if part:IsA("BasePart") then
                  part.CanCollide = false
               end
            end
         end
      end)
   end
end

local function ToggleFly(state)
   FlyEnabled = state
   if BV then BV:Destroy() BV = nil end
   if FlyConn then FlyConn:Disconnect() FlyConn = nil end
   if state and RootPart then
      BV = Instance.new("BodyVelocity")
      BV.MaxForce = Vector3.new(1e9,1e9,1e9)
      BV.Parent = RootPart
      FlyConn = RunService.Heartbeat:Connect(function()
         if not FlyEnabled or not RootPart then return end
         BV.Velocity = Vector3.new(0,0,0)
      end)
   else
      if Humanoid then
         Humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
      end
   end
end

UserInputService.JumpRequest:Connect(function()
   if InfiniteJump and Humanoid then
      Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
   end
end)

RunService.Heartbeat:Connect(function()
   if not Character or not RootPart then return end
   local enemies = GetEnemies()

   if KillAura then
      for _, data in ipairs(enemies) do
         onHitRemote:FireServer(data.hum, 9e9, {}, 0)
      end
   end

   if AutoFarm then
      if #enemies > 0 then
         local closest = enemies[1]
         for _, e in ipairs(enemies) do
            if (RootPart.Position - e.hrp.Position).Magnitude <
               (RootPart.Position - closest.hrp.Position).Magnitude then
               closest = e
            end
         end
         RootPart.CFrame = CFrame.new(
            closest.hrp.Position.X,
            closest.hrp.Position.Y + FarmHeightOffset,
            closest.hrp.Position.Z
         )
         onHitRemote:FireServer(closest.hum, 9e9, {}, 0)
      else
         for _, p in ipairs(Workspace:GetDescendants()) do
            if p:IsA("ProximityPrompt") and p.Enabled then
               RootPart.CFrame = p.Parent.CFrame * CFrame.new(0, FarmHeightOffset, 0)
               fireproximityprompt(p)
               task.wait(0.5)
               break
            end
         end
      end
   end
end)

local FarmTab = Window:CreateTab("Auto Farm")
local MoveTab = Window:CreateTab("Movement")
local VisualTab = Window:CreateTab("Visual")

FarmTab:CreateToggle({Name="Kill Aura",CurrentValue=false,Callback=function(v)KillAura=v end})
FarmTab:CreateToggle({Name="Auto Farm",CurrentValue=false,Callback=function(v)AutoFarm=v end})

MoveTab:CreateToggle({Name="Fly",CurrentValue=false,Callback=function(v)ToggleFly(v)end})
MoveTab:CreateToggle({Name="Noclip",CurrentValue=false,Callback=function(v)ToggleNoClip(v)end})
MoveTab:CreateToggle({Name="Infinite Jump",CurrentValue=false,Callback=function(v)InfiniteJump=v end})
MoveTab:CreateSlider({Name="Walk Speed",Range={16,200},Increment=5,CurrentValue=16,Callback=function(v)WalkSpeedVal=v Humanoid.WalkSpeed=v end})
MoveTab:CreateSlider({Name="Jump Power",Range={50,300},Increment=10,CurrentValue=50,Callback=function(v)JumpPowerVal=v Humanoid.JumpPower=v end})

VisualTab:CreateToggle({Name="Fullbright",CurrentValue=false,Callback=function(v)
   Fullbright=v
   if v then
      Lighting.Brightness=2
      Lighting.ClockTime=14
      Lighting.FogEnd=1e9
      Lighting.GlobalShadows=false
   else
      Lighting.GlobalShadows=true
   end
end})

Rayfield:Notify({
   Title = "Pablo OP",
   Content = "Auto Farm estabilizado para PixelBlade",
   Duration = 6
})

print("Pablo OP - Script completo carregado")
